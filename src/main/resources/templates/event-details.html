<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title th:text="${eventDetails.title}"></title>
</head>
<body>
<div th:replace="~{fragments/navbar}"></div>

<!-- Сообщения -->
<div th:if="${errorMessage}" style="padding: 1rem; margin-bottom: 1rem; background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 5px;">
    <p th:text="${errorMessage}" style="margin: 0; color: #721c24;"></p>
</div>

<div th:if="${successMessage}" style="padding: 1rem; margin-bottom: 1rem; background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 5px;">
    <p th:text="${successMessage}" style="margin: 0; color: #155724;"></p>
</div>

<p><a th:href="@{/events/all}">← Вернуться к списку мероприятий</a></p>

<h1 th:text="${eventDetails.title}"></h1>

<!-- Картинка -->
<div>
    <img th:src="${eventDetails.imageUrl}"
         th:alt="${eventDetails.title}"
         width="400">
</div>

<p><strong>Описание:</strong> <span th:text="${eventDetails.description}"></span></p>
<p><strong>Дата и время:</strong> <span th:text="${#temporals.format(eventDetails.dateTime, 'dd.MM.yyyy HH:mm')}"></span></p>
<p><strong>Зал:</strong> <span th:text="${eventDetails.hallName}"></span></p>
<p><strong>Адрес зала:</strong> <span th:text="${eventDetails.hallAddress}"></span></p>
<p><strong>Вместимость:</strong> <span th:text="${eventDetails.capacity}"></span> мест</p>
<p><strong>Свободных мест:</strong> <span th:text="${eventDetails.availableSeats}"></span></p>

<div th:if="${eventDetails.genreName}">
    <p><strong>Жанр:</strong> <span th:text="${eventDetails.genreName}"></span></p>
</div>

<!-- Действия -->
<div style="margin-top: 1rem;">
    <span sec:authorize="!hasRole('ROLE_ADMIN')">
        <a th:href="@{/bookings/create/{title}(title=${eventDetails.title})}">Бронировать билеты</a>
    </span>

    <span sec:authorize="hasRole('ROLE_ADMIN')" style="margin-left: 1rem;">
        <form th:action="@{/events/event-delete/{event-title}(event-title=${eventDetails.title})}"
              method="post"
              style="display: inline;"
              onsubmit="return confirm('Вы уверены, что хотите удалить мероприятие \'' + '[[${eventDetails.title}]]' + '\'?')">
            <button type="submit">Удалить мероприятие</button>
        </form>
    </span>
</div>

</body>

<footer th:replace="fragments/footer"></footer>

</html>